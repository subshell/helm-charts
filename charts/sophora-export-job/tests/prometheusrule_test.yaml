suite: test prometheusrule
templates:
  - prometheusrule.yaml
tests:
  - it: should create extra rule
    values:
      - ./values/prometheusrule.yaml
    asserts:
      - hasDocuments:
          count: 1
      - isKind:
          of: PrometheusRule
      - equal:
          path: metadata.name
          value: RELEASE-NAME-sophora-export-job
      - equal:
          path: spec.groups[0].name
          value: RELEASE-NAME-sophora-export-job
      - equal:
          path: spec.groups[0].rules[0].alert
          value: SophoraExportJobDidNotExportDocuments
      - equal:
          path: spec.groups[0].rules[1].alert
          value: SophoraExportJobFailed
      - equal:
          path: spec.groups[0].rules[2].alert
          value: SophoraExportJobDidNotUpdate
      - equal:
          path: spec.groups[0].rules[3].alert
          value: Foo
