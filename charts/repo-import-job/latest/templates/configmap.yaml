apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "sophora-repo-import.fullname" . }}
  labels:
  {{- include "sophora-repo-import.labels" . | nindent 4 }}
data:
  application.yml: |-
    sophora:
      client:
        server-connection:
          urls: {{.Values.sophora.serverUrl}}
          username: # in secret
          password: # in secret
          retries: 15
          retry-interval: 10
        toolInfo:
          enabled: false

    importer:
      name: Admin-Importer

      # Defaults for all instances.
      folders:
        watchCheckInterval: 1000
        watchRecursive: true

      webService:
        enabled: false

      filenamesAddTimestamp: true

      cleanupFoldersCron: "0 0 9 ? * * *" # every day at 9AM
      cleanupFoldersSuccessfulMaxAge: 1 # in days
      cleanupFoldersFailureMaxAge: 7 # in days
      keepTempfiles: false

      # Configuration of the importer instances
      instances:
      - name: Admin Import
        key: admin
        transform: skipTransform
        folders:
          watch: /import/admin/incoming
          temp: /import/admin/temp
          success: /import/admin/success
          failure: /import/admin/failure
          xsl: /xsl
        defaultStructureNode: /import
  script.sh: |-
